{"version":3,"file":"index.js","sources":["../src/manager.ts","../src/button.ts","../src/index.ts"],"sourcesContent":["/*! Copyright 2016 - 2023 Ayogo Health Inc. */\n\nexport class MenuManager {\n    private static supportsPopover : boolean | null             = null;\n    private static curMenu : HTMLMenuElement | null             = null;\n    private static curButton : HTMLButtonElement | null         = null;\n    private static isOpen : boolean                             = false;\n    private static focusCount : number | null                   = null;\n    private static transitionEndHandler : (() => void) | null   = null;\n    private static scrollJack : (() => void) | null             = null;\n\n\n    static get open() {\n        return this.isOpen;\n    }\n\n    static get usePopover() {\n        if (this.supportsPopover === null) {\n            this.supportsPopover = HTMLElement.prototype.hasOwnProperty('popover');\n        }\n        return this.supportsPopover;\n    }\n\n    static openMenu(btn : HTMLButtonElement, focus : boolean = false) {\n        if (this.transitionEndHandler !== null) {\n            this.transitionEndHandler();\n        }\n\n        let mnuID = btn.getAttribute('menu');\n        if (!mnuID) {\n            return;\n        }\n\n        let mnu = btn.ownerDocument!.getElementById(mnuID);\n        if (!mnu) {\n            return;\n        }\n\n        this.curButton = btn;\n        this.curMenu = mnu as HTMLMenuElement;\n        this.isOpen = true;\n\n        this.curButton.setAttribute('aria-expanded', 'true');\n        this.curButton.ownerDocument!.documentElement.addEventListener('click', this.clickListener);\n        this.curButton.addEventListener('blur', this.handleBlur);\n\n        if (this.usePopover) {\n            this.curMenu.showPopover();\n        } else {\n            // Before we open the menu, we need to move it in the DOM so that is\n            // is directly after the button element for tab ordering\n            this.curButton.parentNode!.insertBefore(this.curMenu, this.curButton.nextSibling);\n        }\n\n        let offset = this.getScrollOffset();\n\n        this.addMenuStyle();\n\n        this.scrollJack = this.blockScrolling(offset);\n\n        if (focus) {\n            this.focusMenu();\n        }\n\n        this.curMenu.addEventListener('keydown', this.menuKeypressListener);\n        this.curMenu.addEventListener('focusout', this.handleBlur);\n        this.curMenu.addEventListener('click', this.menuClickListener);\n    }\n\n\n    static closeMenu() {\n        if (!this.isOpen || !this.curButton || !this.curMenu) {\n            return;\n        }\n\n        this.curButton.ownerDocument!.documentElement.removeEventListener('click', this.clickListener);\n        this.curButton.removeEventListener('blur', this.handleBlur);\n        this.curButton.setAttribute('aria-expanded', 'false');\n        this.curButton.setAttribute('data-dir', 'down');\n\n        this.curMenu.removeEventListener('keydown', this.menuKeypressListener);\n        this.curMenu.removeEventListener('focusout', this.handleBlur);\n        this.curMenu.removeEventListener('click', this.menuClickListener);\n\n        if (this.scrollJack) {\n            this.scrollJack();\n        }\n\n        let oldMenu = this.curMenu;\n        this.transitionEndHandler = () => {\n            if (this.usePopover) {\n                oldMenu.hidePopover();\n            }\n            oldMenu.removeAttribute('style');\n            oldMenu.removeEventListener('transitionend', this.transitionEndHandler!);\n            oldMenu.removeEventListener('webkittransitionend', this.transitionEndHandler!);\n            this.transitionEndHandler = null;\n        };\n\n        if ('transitionDuration' in oldMenu.style) {\n            oldMenu.style.transitionDuration = '192ms';\n        } else {\n            (oldMenu.style as any).webkitTransitionDuration = '192ms';\n        }\n\n        if ('transform' in oldMenu.style) {\n            oldMenu.style.transform = 'scaleY(0)';\n        } else {\n            (oldMenu.style as any).webkitTransform = 'scaleY(0)';\n        }\n\n        oldMenu.addEventListener('transitionend', this.transitionEndHandler!);\n        oldMenu.addEventListener('webkittransitionend', this.transitionEndHandler!);\n\n        this.isOpen = false;\n        this.curButton = null;\n        this.curMenu = null;\n        this.focusCount = null;\n    }\n\n\n    static toggleMenu(btn : HTMLButtonElement) {\n        let openMnu = this.curMenu;\n\n        if (this.isOpen) {\n            this.closeMenu();\n        }\n\n        if (!openMnu || openMnu.getAttribute('id') !== btn.getAttribute('menu')) {\n            this.openMenu(btn);\n        }\n    }\n\n\n    static focusMenu(offset = 1) {\n        if (!this.curMenu) {\n            return;\n        }\n\n        if (this.focusCount === null) {\n            this.focusCount = 0;\n        }\n\n        let length = this.curMenu.children.length;\n\n        if (this.focusCount < 0) {\n            this.focusCount += length;\n        }\n\n        let mi = this.curMenu.children[this.focusCount % length] as HTMLElement;\n        const role = mi.getAttribute('role');\n        if (role === 'presentation' || role === 'separator' || role === 'none') {\n            this.focusCount += offset;\n            this.focusMenu(offset);\n        } else {\n            mi.focus();\n        }\n    }\n\n\n    private static clickMenuItem() {\n        if (!this.curMenu) {\n            return;\n        }\n\n        let length = this.curMenu.children.length;\n        let mi = this.curMenu.children[(this.focusCount || 0) % length] as HTMLElement;\n\n        if (!mi.hasAttribute('disabled')) {\n            mi.click();\n        }\n    }\n\n\n    private static addMenuStyle() {\n        if (!this.curMenu || !this.curButton) {\n            return;\n        }\n\n        let menu = this.curMenu!;\n        let btn = this.curButton!;\n        let btnSize = btn.getBoundingClientRect();\n\n        // Add the menu to the DOM for measuring\n        if (!this.usePopover) {\n            menu.style.display = 'block';\n            menu.style.position = 'fixed';\n        }\n        menu.setAttribute('role', 'menu');\n        menu.setAttribute('data-owner', 'button');\n\n        // Try to unset the type so Firefox can make it visible :'(\n        menu.setAttribute('type', '');\n\n        // Ensure the children are focusable, if they don't have a different role explicitly set already\n        for (let i = 0; i < menu.children.length; i++) {\n            if (menu.children[i].tagName === 'HR') {\n                menu.children[i].setAttribute('role', 'separator');\n            }\n\n            if (menu.children[i].hasAttribute('role') && menu.children[i].getAttribute('role') !== 'menuitem') {\n                continue;\n            }\n\n            menu.children[i].setAttribute('tabindex', '-1');\n            menu.children[i].setAttribute('role', 'menuitem');\n\n            menu.children[i].setAttribute('aria-disabled', menu.children[i].hasAttribute('disabled').toString());\n        }\n\n        requestAnimationFrame(() => {\n            let menuSize = menu.getBoundingClientRect();\n            let wndHeight = window.innerHeight;\n\n            if (btnSize.bottom + menuSize.height > wndHeight) {\n                menu.style.top = (btnSize.top - menuSize.height) + 'px';\n                btn.setAttribute('data-dir', 'up');\n                menu.setAttribute('data-dir', 'up');\n            } else {\n                menu.style.top = btnSize.bottom + 'px';\n                btn.setAttribute('data-dir', 'down');\n                menu.setAttribute('data-dir', 'down');\n            }\n\n            if (menuSize.width > btnSize.right) {\n                menu.style.left = btnSize.left + 'px';\n            } else {\n                menu.style.left = (btnSize.right - menuSize.width) + 'px';\n            }\n\n            if ('transform' in menu.style) {\n                menu.style.transform = 'scaleY(0)';\n\n                requestAnimationFrame(() => {\n                    menu.style.transform = 'scaleY(1)';\n                });\n            } else {\n                (menu.style as any).webkitTransform = 'scaleY(0)';\n\n                requestAnimationFrame(() => {\n                    (menu.style as any).webkitTransform = 'scaleY(1)';\n                });\n            }\n        });\n    }\n\n\n    private static clickListener(e : MouseEvent) {\n        if (!MenuManager.curButton || !MenuManager.curMenu) {\n            return;\n        }\n\n        if (MenuManager.curMenu.contains(e.target as Node)) {\n            return;\n        }\n\n        if (MenuManager.curButton.contains(e.target as Node)) {\n            return;\n        }\n\n        MenuManager.curButton.focus();\n        MenuManager.closeMenu();\n    }\n\n\n    private static menuClickListener(e : MouseEvent) {\n        if (!MenuManager.curButton || !MenuManager.curMenu) {\n            return;\n        }\n\n        let mi = e.target as HTMLElement;\n\n        if (!MenuManager.curMenu.contains(mi)) {\n            return;\n        }\n\n        if (mi.hasAttribute('disabled')) {\n            return;\n        }\n\n        MenuManager.curButton.focus();\n        MenuManager.closeMenu();\n    }\n\n\n    private static handleBlur(e : FocusEvent) {\n        if (!MenuManager.curButton) {\n            return;\n        }\n\n        // Element that focus is moving to\n        let activeEl = e.relatedTarget as HTMLElement | null;\n\n        if (!activeEl) {\n            return;\n        }\n\n        if (MenuManager.curButton === activeEl) {\n            return;\n        }\n\n        if (MenuManager.curMenu && MenuManager.curMenu.contains(activeEl)) {\n            return;\n        }\n\n        // Wait until after focus has moved before closing the menu\n        setTimeout(() => {\n            if (MenuManager.isOpen) {\n                MenuManager.closeMenu();\n            }\n        }, 0);\n    }\n\n\n    private static menuKeypressListener(e : KeyboardEvent) {\n        if (!MenuManager.isOpen) {\n            return;\n        }\n\n        // Escape\n        if (e.keyCode === 27) {\n            if (MenuManager.curButton) {\n                MenuManager.curButton.focus();\n            }\n\n            MenuManager.closeMenu();\n        }\n\n        // Up Arrow\n        if (e.keyCode === 38) {\n            e.preventDefault();\n            e.stopPropagation();\n\n            if (MenuManager.focusCount !== null) {\n                MenuManager.focusCount--;\n            }\n            MenuManager.focusMenu(-1);\n        }\n\n        // Down Arrow\n        if (e.keyCode === 40) {\n            e.preventDefault();\n            e.stopPropagation();\n\n            if (MenuManager.focusCount !== null) {\n                MenuManager.focusCount++;\n            }\n            MenuManager.focusMenu(1);\n        }\n\n\n        // Enter and Spacebar\n        if (e.keyCode === 32 || e.keyCode === 13) {\n            e.preventDefault();\n            e.stopPropagation();\n\n            MenuManager.clickMenuItem();\n        }\n    }\n\n\n    private static getScrollOffset() {\n        let doc = this.curButton!.ownerDocument!;\n\n        if (doc.body.style.top) {\n            return Math.abs(parseInt(doc.body.style.top, 10));\n        }\n\n        if (doc.scrollingElement) {\n            return doc.scrollingElement.scrollTop;\n        } else {\n            return doc.documentElement.scrollTop + doc.body.scrollTop;\n        }\n    }\n\n\n    private static blockScrolling(offset : number) {\n        let doc = this.curButton!.ownerDocument!;\n        let htmlNode = doc.documentElement;\n        let clientWidth = doc.body.clientWidth;\n\n        if (doc.body.scrollHeight > htmlNode.clientHeight) {\n            doc.body.style.position = 'fixed';\n            doc.body.style.left = '0';\n            doc.body.style.right = '0';\n            doc.body.style.top = -offset + 'px';\n\n            htmlNode.style.minHeight = '100vh';\n            htmlNode.style.overflowY = 'scroll';\n        }\n\n        if (doc.body.clientWidth < clientWidth) {\n            doc.body.style.overflow = 'hidden';\n        }\n\n        return function() {\n            doc.body.style.removeProperty('position');\n            doc.body.style.removeProperty('left');\n            doc.body.style.removeProperty('right');\n            doc.body.style.removeProperty('top');\n            doc.body.style.removeProperty('overflow');\n            htmlNode.style.removeProperty('overflow-y');\n            htmlNode.style.removeProperty('min-height');\n\n            if (doc.scrollingElement) {\n                doc.scrollingElement.scrollTop = offset;\n            } else {\n                scrollTo(0, offset);\n            }\n        };\n    }\n}\n","/*! Copyright 2016 - 2023 Ayogo Health Inc. */\n\nimport { MenuManager } from './manager';\n\nexport class MenuButtonBehaviour {\n    private el: null | HTMLButtonElement;\n\n    private clickHandler : null | (() => void);\n    private keyHandler : null | ((e : KeyboardEvent) => void);\n    private resizeHandler : null | (() => void);\n\n    constructor(btn : HTMLButtonElement) {\n        this.el = btn;\n\n        this.el.setAttribute('aria-haspopup', 'true');\n        this.el.setAttribute('aria-expanded', 'false');\n\n        this.clickHandler = () => {\n            MenuManager.toggleMenu(this.el!);\n        };\n\n        this.keyHandler = (e : KeyboardEvent) => {\n            this.buttonKeypressListener(e);\n        };\n\n        this.resizeHandler = () => {\n            MenuManager.closeMenu();\n        };\n\n        this.el.addEventListener('click', this.clickHandler!);\n        this.el.addEventListener('keydown', this.keyHandler!);\n        window.addEventListener('resize', this.resizeHandler!);\n    }\n\n\n    // Cleanup function\n    destroy() {\n        if (this.el) {\n            this.el.removeEventListener('click', this.clickHandler!);\n            this.el.removeEventListener('keydown', this.keyHandler!);\n            window.removeEventListener('resize', this.resizeHandler!);\n        }\n\n        this.clickHandler = null;\n        this.keyHandler = null;\n        this.resizeHandler = null;\n        this.el = null;\n    }\n\n\n    private buttonKeypressListener(e : KeyboardEvent) {\n        // Escape\n        if (MenuManager.open && e.keyCode == 27) {\n            MenuManager.closeMenu();\n        }\n\n        // DOWN ARROW\n        if (e.keyCode == 40) {\n            if (!MenuManager.open) {\n                MenuManager.openMenu(this.el!, true);\n            } else {\n                MenuManager.focusMenu();\n            }\n        }\n    }\n}\n","/*! Copyright 2016 - 2023 Ayogo Health Inc. */\n\n\nimport { MenuManager } from './manager';\nimport { MenuButtonBehaviour } from './button';\n\nconst MENU_STYLES = `\nmenu[type=\"context\"]:not([popover]),\nmenu[data-owner=\"button\"]:not([popover]) {\n    display: none;\n}\n\nmenu[type=\"context\"],\nmenu[data-owner=\"button\"] {\n    padding: 0.125em;\n    margin: 0;\n    border: 1px solid;\n    background: Menu;\n    will-change: transform;\n    transform-origin: top center;\n    transition: transform 225ms cubic-bezier(0.4, 0.0, 0.2, 1);\n}\n\nmenu[type=\"context\"][data-dir=\"up\"]:not([popover]),\nmenu[data-owner=\"button\"][data-dir=\"up\"]:not([popover]) {\n    transform-origin: bottom center;\n}\n\nmenuitem {\n    display: list-item;\n    list-style-type: none;\n    background: Menu;\n    font: menu;\n    padding: 0.25em 0.5em;\n    cursor: default;\n}\n\nmenuitem::after {\n    content: attr(label);\n}\n\nmenuitem[disabled] {\n    color: GrayText;\n}\n\nmenuitem:not([disabled]):hover,\nmenuitem:not([disabled]):focus {\n    background: Highlight;\n    color: HighlightText;\n}\n\nbutton[type=\"menu\"]::after,\nbutton[data-type=\"menu\"]:after { content: ' ▾'; }\n\nbutton[type=\"menu\"]:empty::after,\nbutton[data-type=\"menu\"]:empty:after { content: '▾'; } /* No space character */\n\nbutton[type=\"menu\"][data-dir=\"up\"]::after,\nbutton[data-type=\"menu\"][data-dir=\"up\"]:after { content: ' ▴'; }\n\nbutton[type=\"menu\"][data-dir=\"up\"]:empty::after,\nbutton[data-type=\"menu\"][data-dir=\"up\"]:empty:after { content: '▴'; } /* No space character */\n`;\n\n\nconst PREFIX_STYLES = `\nmenu[type=\"context\"],\nmenu[data-owner=\"button\"] {\n    -webkit-transform-origin: top center;\n    -webkit-transition: -webkit-transform 225ms cubic-bezier(0.4, 0.0, 0.2, 1);\n    transition: -webkit-transform 225ms cubic-bezier(0.4, 0.0, 0.2, 1);\n}\n\nmenu[type=\"context\"][data-dir=\"up\"]:not([popover]),\nmenu[data-owner=\"button\"][data-dir=\"up\"]:not([popover]) {\n    -webkit-transform-origin: bottom center;\n}\n`\n\n\n// Inject default styling\n\nlet mnuStyle = document.createElement('style');\nmnuStyle.appendChild(document.createTextNode(MENU_STYLES));\n\n// Add old prefixed styles for older iOS and Android devices\nif (!('transform' in document.createElement('div').style)) {\n    mnuStyle.appendChild(document.createTextNode(PREFIX_STYLES));\n}\n\n\nlet insertPoint : HTMLElement | null;\nif (insertPoint = document.querySelector('link')) {\n    insertPoint.parentNode!.insertBefore(mnuStyle, insertPoint);\n} else\nif (insertPoint = document.querySelector('style')) {\n    insertPoint.parentNode!.insertBefore(mnuStyle, insertPoint);\n} else\nif (insertPoint = document.querySelector('head')) {\n    insertPoint.appendChild(mnuStyle);\n} else {\n    document.appendChild(mnuStyle);\n}\n\n\nlet gcCache : WeakMap<HTMLButtonElement, MenuButtonBehaviour> | null = null;\nif ('WeakMap' in window) {\n    gcCache = new WeakMap();\n}\n\n\nexport default function MenuButton(el : HTMLButtonElement) {\n    if (!el.hasAttribute('menu')) {\n        throw new Error('Cannot construct a menu button without a menu attribute');\n    }\n\n    const menu = document.getElementById(el.getAttribute('menu')!);\n    if (!menu) {\n        throw new Error(`Could not find menu element #${el.getAttribute('menu')} for button`);\n    }\n\n    if (MenuManager.usePopover) {\n        menu.setAttribute('popover', 'manual');\n    }\n\n    let behaviour = new MenuButtonBehaviour(el);\n\n    if (gcCache) {\n        gcCache.set(el, behaviour);\n    }\n\n    return behaviour;\n}\n"],"names":[],"mappings":"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"}